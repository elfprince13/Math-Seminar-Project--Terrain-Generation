<?xml version="1.0" encoding="UTF-8"?>
<Worksheet>
<Version major="16" minor="2"/>
<Label-Scheme value="2" prefix=""/>
<View-Properties presentation="false"></View-Properties>
<MapleNet-Properties elisiondigitsbefore="100" labelling="true" indentamount="4" elisiontermsthreshold="10000" ansi="false" errorbreak="1" useclientjvm="true" echo="1" imaginaryunit="I" labelwidth="20" contextmenusize="automatic" plotdriver="opengl" elisiondigitsafter="100" plotoutput="terminal" helpbrowser="standard" rtablesize="10" elisiontermsbefore="100" elisiondigitsthreshold="10000" typesetting="standard" plotdevice="inline" verboseproc="1" showassumed="1" errorcursor="false" longdelim="true" plotoptions="" quiet="false" elisiontermsafter="100" screenwidth="79" preplot="" prettyprint="3" displayprecision="-1" screenpixelheight="900" warnlevel="3" screenheight="25" latexwidth="6.0" postplot="" prompt="&gt; " ShowLabels="true"/>
<Styles><Font name="Ordered List 1" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Annotation Text" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Ordered List 2" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Ordered List 3" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Ordered List 4" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Ordered List 5" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Author" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Annotation Title" background="[255,255,255]" bold="true" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="18" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Warning" background="[255,255,255]" bold="false" executable="false" family="Courier New" foreground="[0,0,255]" italic="false" opaque="false" readonly="true" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Caption Reference" background="[255,255,255]" bold="true" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Maple Input Placeholder" background="[255,255,255]" bold="true" executable="true" family="Courier New" foreground="[200,0,200]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="true"/>
<Font name="Maple Plot" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Code" background="[255,255,255]" bold="false" executable="false" family="Courier New" foreground="[255,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Line Printed Output" background="[255,255,255]" bold="false" executable="false" family="Courier New" foreground="[0,0,255]" italic="false" opaque="false" readonly="true" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Text Output" background="[255,255,255]" bold="false" executable="false" family="Courier New" foreground="[0,0,255]" italic="false" opaque="false" readonly="true" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Diagnostic" background="[255,255,255]" bold="false" executable="false" family="Courier New" foreground="[40,120,40]" italic="false" opaque="false" readonly="true" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="2D Inert Output" background="[255,255,255]" bold="false" executable="true" family="Times New Roman" foreground="[144,144,144]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Normal" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Hyperlink" background="[255,255,255]" bold="false" executable="false" family="Times New Roma" foreground="[0,128,128]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="true" placeholder="false"/>
<Font name="Maple Output" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Dash Item" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="2D Math" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Maple Input" background="[255,255,255]" bold="true" executable="true" family="Courier New" foreground="[255,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="2D Output" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,255]" italic="false" opaque="false" readonly="true" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="2D Input" background="[255,255,255]" bold="false" executable="true" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="HyperlinkError" background="[255,255,255]" bold="false" executable="false" family="Courier New" foreground="[255,0,255]" italic="false" opaque="false" readonly="true" size="12" subscript="false" superscript="false" underline="true" placeholder="false"/>
<Font name="Header and Footer" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="10" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Error" background="[255,255,255]" bold="false" executable="false" family="Courier New" foreground="[255,0,255]" italic="false" opaque="false" readonly="true" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Title" background="[255,255,255]" bold="true" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="18" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Heading 1" background="[255,255,255]" bold="true" executable="false" family="Times New Roma" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="18" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Text" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Bullet Item" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Heading 4" background="[255,255,255]" bold="false" executable="false" family="Times New Roma" foreground="[0,0,0]" italic="true" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Equation Label" background="[255,255,255]" bold="true" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Heading 3" background="[255,255,255]" bold="true" executable="false" family="Times New Roma" foreground="[0,0,0]" italic="true" opaque="false" readonly="false" size="14" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Heading 2" background="[255,255,255]" bold="true" executable="false" family="Times New Roma" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="16" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="HyperlinkWarning" background="[255,255,255]" bold="false" executable="false" family="Courier New" foreground="[0,0,255]" italic="false" opaque="false" readonly="true" size="12" subscript="false" superscript="false" underline="true" placeholder="false"/>
<Font name="Dictionary Hyperlink" background="[255,255,255]" bold="false" executable="false" family="Times New Roma" foreground="[147,0,15]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="true" placeholder="false"/>
<Font name="Caption Text" background="[255,255,255]" bold="true" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="List Item" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Layout name="Ordered List 1" alignment="left" bullet="numeric" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="3" spacebelow="3" linebreak="space" pagebreak-before="false" initial="-1" bulletsuffix=""/>
<Layout name="Ordered List 2" alignment="left" bullet="alphabetic" firstindent="0" leftmargin="36" rightmargin="0" linespacing="0.0" spaceabove="3" spacebelow="3" linebreak="space" pagebreak-before="false" initial="-1" bulletsuffix=""/>
<Layout name="Ordered List 3" alignment="left" bullet="roman" firstindent="0" leftmargin="72" rightmargin="0" linespacing="0.0" spaceabove="3" spacebelow="3" linebreak="space" pagebreak-before="false" initial="-1" bulletsuffix=""/>
<Layout name="Ordered List 4" alignment="left" bullet="ALPHABETIC" firstindent="0" leftmargin="108" rightmargin="0" linespacing="0.0" spaceabove="3" spacebelow="3" linebreak="space" pagebreak-before="false" initial="-1" bulletsuffix=""/>
<Layout name="Ordered List 5" alignment="left" bullet="ROMAN" firstindent="0" leftmargin="144" rightmargin="0" linespacing="0.0" spaceabove="3" spacebelow="3" linebreak="space" pagebreak-before="false" initial="-1" bulletsuffix=""/>
<Layout name="Author" alignment="centred" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="8" spacebelow="8" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Warning" alignment="left" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="0" spacebelow="0" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Annotation Title" alignment="centred" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="12" spacebelow="12" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Maple Plot" alignment="centred" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="0" spacebelow="0" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Line Printed Output" alignment="left" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="0" spacebelow="0" linebreak="any" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Text Output" alignment="left" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="0" spacebelow="0" linebreak="newline" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Diagnostic" alignment="left" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="0" spacebelow="0" linebreak="any" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Normal" alignment="left" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="0" spacebelow="0" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Maple Output" alignment="centred" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.3" spaceabove="0" spacebelow="0" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Dash Item" alignment="left" bullet="dash" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="3" spacebelow="3" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="HyperlinkError" alignment="left" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="0" spacebelow="0" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Error" alignment="left" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="0" spacebelow="0" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Title" alignment="centred" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="12" spacebelow="12" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Heading 1" alignment="left" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="8" spacebelow="4" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Bullet Item" alignment="left" bullet="dot" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="3" spacebelow="3" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Heading 4" alignment="left" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="0" spacebelow="0" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Heading 3" alignment="left" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="0" spacebelow="0" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Heading 2" alignment="left" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="8" spacebelow="2" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="HyperlinkWarning" alignment="left" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="0" spacebelow="0" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="List Item" alignment="left" bullet="indent" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="3" spacebelow="3" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Pencil-style name="Pencil 5" pen-color="[255,0,0]" pen-height="5.0" pen-width="5.0" pen-opacity="1.0"/>
<Pencil-style name="Pencil 4" pen-color="[0,0,255]" pen-height="3.0" pen-width="3.0" pen-opacity="1.0"/>
<Pencil-style name="Pencil 3" pen-color="[0,0,0]" pen-height="3.0" pen-width="3.0" pen-opacity="1.0"/>
<Pencil-style name="Pencil 2" pen-color="[0,0,255]" pen-height="1.0" pen-width="1.0" pen-opacity="1.0"/>
<Pencil-style name="Pencil 1" pen-color="[0,0,0]" pen-height="1.0" pen-width="1.0" pen-opacity="1.0"/>
<Highlighter-style name="Highlighter 2" pen-color="[255,204,0]" pen-height="14.0" pen-width="14.0" pen-opacity="0.8"/>
<Highlighter-style name="Highlighter 1" pen-color="[255,153,255]" pen-height="12.0" pen-width="8.0" pen-opacity="0.8"/>
<Highlighter-style name="Highlighter 4" pen-color="[0,255,255]" pen-height="32.0" pen-width="32.0" pen-opacity="0.8"/>
<Highlighter-style name="Highlighter 3" pen-color="[51,255,0]" pen-height="24.0" pen-width="24.0" pen-opacity="0.8"/>
<Highlighter-style name="Highlighter 5" pen-color="[255,255,0]" pen-height="48.0" pen-width="48.0" pen-opacity="0.8"/>
</Styles>
<Task-table>
    <Task-category name="&lt;default&gt;">
    </Task-category>
</Task-table>
<Task>
</Task>
<Group labelreference="L1" drawlabel="true">
<Input>
<Text-field prompt="&gt; " style="Maple Input" layout="Normal">restart: with(plots): with(RandomTools): with(DiscreteTransforms): with(Statistics):</Text-field>
</Input>
</Group>
<Group labelreference="L59" drawlabel="true">
<Input>
<Text-field prompt="&gt; " style="Maple Input" layout="Normal">wrapto := proc (n, p) options operator, arrow; piecewise(`mod`(n, p) = 0, p, `mod`(n, p) &lt;&gt; 0, `mod`(n, p)) end proc:</Text-field>
</Input>
</Group>
<Group labelreference="L3" drawlabel="true">
<Input>
<Text-field prompt="&gt; " style="Maple Input" layout="Normal">MidpointAlgo := proc (tdata, xsi, xfi, ysi, yfi, params) local q, endpoints, xs, xf, ys, yf, errscale, smoothing:errscale := params[1]: smoothing := params[2]:q := SimpleQueue([xsi, xfi, ysi, yfi]):while not q:-empty() do endpoints := q:-dequeue():xs, xf, ys, yf := seq(endpoints[i], i = 1 .. 4): tdata[(1/2)*xf+(1/2)*xs, ys] := (1/2)*tdata[xs, ys]+(1/2)*tdata[xf, ys]+errscale*2^(-smoothing*(N-log[2](xf-xs)))*Generate(float(range = -1 .. 1)):tdata[(1/2)*xf+(1/2)*xs, yf] := (1/2)*tdata[xs, yf]+(1/2)*tdata[xf, yf]+errscale*2^(-smoothing*(N-log[2](xf-xs)))*Generate(float(range = -1 .. 1)): tdata[xs, (1/2)*yf+(1/2)*ys] := (1/2)*tdata[xs, ys]+(1/2)*tdata[xs, yf]+errscale*2^(-smoothing*(N-log[2](yf-ys)))*Generate(float(range = -1 .. 1)):tdata[xf, (1/2)*yf+(1/2)*ys] := (1/2)*tdata[xf, ys]+(1/2)*tdata[xf, yf]+errscale*2^(-smoothing*(N-log[2](yf-ys)))*Generate(float(range = -1 .. 1)):tdata[(1/2)*xf+(1/2)*xs, (1/2)*yf+(1/2)*ys] := (1/4)*tdata[xf, ys]+(1/4)*tdata[xf, yf]+(1/4)*tdata[xs, ys]+(1/4)*tdata[xs, yf]+errscale*2^(-smoothing*(N-log[2](xf-xs)))*Generate(float(range = -1 .. 1)):if 3 &lt;= xf-xs then q:-enqueue([xs, (1/2)*xf+(1/2)*xs, ys, (1/2)*yf+(1/2)*ys]):q:-enqueue([(1/2)*xf+(1/2)*xs, xf, ys, (1/2)*yf+(1/2)*ys]):q:-enqueue([xs, (1/2)*xf+(1/2)*xs, (1/2)*yf+(1/2)*ys, yf]):q:-enqueue([(1/2)*xf+(1/2)*xs, xf, (1/2)*yf+(1/2)*ys, yf]):end if:end do:tdata;end proc:</Text-field>
</Input>
</Group>
<Group labelreference="L55" drawlabel="true">
<Input>
<Text-field prompt="&gt; " style="Maple Input" layout="Normal">DiamondsAndSquaresAlgo := proc (tdata, xsi, xfi, ysi, yfi, params)local q, endpoints, xs, xf, ys, yf, tdim, xm, ym, errscale, smoothing:errscale := params[1]:smoothing := params[2]:tdim := ArrayDims(tdata):xm := rhs(tdim[1]):ym := rhs(tdim[2]):q := SimpleQueue([xsi, xfi, ysi, yfi]):while not q:-empty() doendpoints := q:-dequeue():xs, xf, ys, yf := seq(endpoints[i], i = 1 .. 4):tdata[(1/2)*xf+(1/2)*xs, (1/2)*yf+(1/2)*ys] := (1/4)*tdata[xf, ys]+(1/4)*tdata[xf, yf]+(1/4)*tdata[xs, ys]+(1/4)*tdata[xs, yf]+errscale*2^(-smoothing*(N-log[2](xf-xs)))*Generate(float(range = -1 .. 1)):tdata[(1/2)*xf+(1/2)*xs, ys] := (1/4)*tdata[xs, ys]+(1/4)*tdata[xf, ys]+(1/4)*tdata[(1/2)*xf+(1/2)*xs, (1/2)*yf+(1/2)*ys]+(1/4)*tdata[(1/2)*xf+(1/2)*xs, wrapto((3/2)*ys-(1/2)*yf, ym)]+errscale*2^(-smoothing*(N-log[2](xf-xs)))*Generate(float(range = -1 .. 1)):tdata[(1/2)*xf+(1/2)*xs, yf] := (1/4)*tdata[xs, yf]+(1/4)*tdata[xf, yf]+(1/4)*tdata[(1/2)*xf+(1/2)*xs, (1/2)*yf+(1/2)*ys]+(1/4)*tdata[(1/2)*xf+(1/2)*xs, wrapto((3/2)*yf-(1/2)*ys, ym)]+errscale*2^(-smoothing*(N-log[2](xf-xs)))*Generate(float(range = -1 .. 1)):tdata[xs, (1/2)*yf+(1/2)*ys] := (1/4)*tdata[xs, ys]+(1/4)*tdata[xs, yf]+(1/4)*tdata[(1/2)*xf+(1/2)*xs, (1/2)*yf+(1/2)*ys]+(1/4)*tdata[wrapto((3/2)*xs-(1/2)*xf, xm), (1/2)*yf+(1/2)*ys]+errscale*2^(-smoothing*(N-log[2](yf-ys)))*Generate(float(range = -1 .. 1)):tdata[xf, (1/2)*yf+(1/2)*ys] := (1/4)*tdata[xf, ys]+(1/4)*tdata[xf, yf]+(1/4)*tdata[(1/2)*xf+(1/2)*xs, (1/2)*yf+(1/2)*ys]+(1/4)*tdata[wrapto((3/2)*xf-(1/2)*xs, xm), (1/2)*yf+(1/2)*ys]+errscale*2^(-smoothing*(N-log[2](yf-ys)))*Generate(float(range = -1 .. 1)):if 3 &lt;= xf-xs thenq:-enqueue([xs, (1/2)*xf+(1/2)*xs, ys, (1/2)*yf+(1/2)*ys]):q:-enqueue([(1/2)*xf+(1/2)*xs, xf, ys, (1/2)*yf+(1/2)*ys]):q:-enqueue([xs, (1/2)*xf+(1/2)*xs, (1/2)*yf+(1/2)*ys, yf]):q:-enqueue([(1/2)*xf+(1/2)*xs, xf, (1/2)*yf+(1/2)*ys, yf]):end if:end do:tdata;end proc:</Text-field>
</Input>
</Group>
<Group labelreference="L89" drawlabel="true">
<Input>
<Text-field prompt="&gt; " style="Maple Input" layout="Normal">FourierAlgo := proc (tdata, xsi, xfi, ysi, yfi, params)local smoothexp, TerrainData, x, y, f:smoothexp := params[1]:TerrainData := Array(xsi .. xfi-1, ysi .. yfi-1, readonly = false):for x from xsi to xfi-1 dofor y from ysi to yfi-1 doTerrainData[x, y] := Generate(distribution(Normal(0, (1/12)*xfi))):end do:end do:FourierTransform(TerrainData, inplace = true, algorithm = mintime):for x from xsi to xfi-1 dofor y from ysi to yfi-1 dof := sqrt(x^2+y^2):TerrainData[x, y] := TerrainData[x, y]/f^smoothexp:end do:end do:InverseFourierTransform(TerrainData, inplace = true, algorithm = mintime):for x from xsi to xfi-1 dofor y from ysi to yfi-1 doTerrainData[x, y] := Re(TerrainData[x, y]):end do:end do:TerrainData*xfi*exp(1+(1/2)*smoothexp);end proc:</Text-field>
</Input>
</Group>
<Group labelreference="L85" drawlabel="true">
<Input>
<Text-field prompt="&gt; " style="Maple Input" layout="Normal">MultiplyTerrains := proc (tdata, xsi, xfi, ysi, yfi, params)local x, y, n, tmp:n := nops(params):for x from xsi to xfi dofor y from ysi to yfi dotmp := product(params[i][x, y], i = 1 .. n):tdata[x, y] := signum(tmp)*abs(tmp)^(1/n):end do:end do:tdata;end proc:</Text-field>
</Input>
</Group>
<Group labelreference="L71" drawlabel="true">
<Input>
<Text-field prompt="&gt; " style="Maple Input" layout="Normal">MakeTerrain := proc (seed, N, Algo, params)local TSIZE, TerrainData, hbound:SetState(state = seed):TSIZE := 1+2^N:hbound := (1/4)*TSIZE:TerrainData := Array(1 .. TSIZE, 1 .. TSIZE, 0, readonly = false):TerrainData[1, 1] := Generate(float(range = -hbound .. hbound)):TerrainData[1, TSIZE] := Generate(float(range = -hbound .. hbound)):TerrainData[TSIZE, 1] := Generate(float(range = -hbound .. hbound)):TerrainData[TSIZE, TSIZE] := Generate(float(range = -hbound .. hbound)):Algo(TerrainData, 1, TSIZE, 1, TSIZE, params);end proc:</Text-field>
</Input>
</Group>
<Group labelreference="L43" drawlabel="true">
<Input>
<Text-field prompt="&gt; " style="Maple Input" layout="Normal">N := 6:TSIZE := 1+2^N:</Text-field>
</Input>
</Group>
<Group labelreference="L48" drawlabel="true">
<Input>
<Text-field prompt="&gt; " style="Maple Input" layout="Normal">mids := MakeTerrain(1234, N, MidpointAlgo, [15, 1]):surfdata(mids, 1 .. TSIZE, 1 .. TSIZE, shading = zhue, scaling = constrained, glossiness = .5, axes = normal, lightmodel = light3, style = patchcontour);</Text-field>
</Input>
</Group>
<Group labelreference="L41" drawlabel="true">
<Input>
<Text-field prompt="&gt; " style="Maple Input" layout="Normal">dands := MakeTerrain(1234, N, DiamondsAndSquaresAlgo, [15, 1]):surfdata(dands, 1 .. TSIZE, 1 .. TSIZE, shading = zhue, scaling = constrained, glossiness = .5, axes = normal, lightmodel = light3, style = patchcontour);</Text-field>
</Input>
</Group>
<Group labelreference="L84" drawlabel="true">
<Input>
<Text-field prompt="&gt; " style="Maple Input" layout="Normal">combo := MakeTerrain(1234, N, MultiplyTerrains, [mids, dands]):surfdata(combo, 1 .. TSIZE, 1 .. TSIZE, shading = zhue, scaling = constrained, glossiness = .5, axes = normal, lightmodel = light3, style = patchcontour);</Text-field>
</Input>
</Group>
<Group labelreference="L87" drawlabel="true">
<Input>
<Text-field prompt="&gt; " style="Maple Input" layout="Normal">fours := MakeTerrain(1234, N, FourierAlgo, [2.8]):surfdata(fours, 1 .. TSIZE-1, 1 .. TSIZE-1, shading = zhue, scaling = constrained, glossiness = .5, axes = normal, lightmodel = light3, style = patchcontour);</Text-field>
</Input>
</Group>
</Worksheet>